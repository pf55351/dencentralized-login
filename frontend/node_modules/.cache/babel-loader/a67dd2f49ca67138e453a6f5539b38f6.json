{"ast":null,"code":"import _regeneratorRuntime from\"/Users/francescoprimerano/Desktop/metamask-login/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/francescoprimerano/Desktop/metamask-login/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/francescoprimerano/Desktop/metamask-login/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback}from\"react\";import\"bulma/css/bulma.min.css\";import{Container,Heading,Content,Button,Image}from\"react-bulma-components\";import Hero from\"react-bulma-components/esm/components/hero\";import Footer from\"react-bulma-components/cjs/components/footer\";import logo from\"./metamask.svg\";import Web3 from\"web3\";import Modal from\"./Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),ethAddress=_useState4[0],setEthAddress=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),fieldsModal=_useState6[0],setFieldsModal=_useState6[1];var web3=new Web3(Web3.givenProvider);var hasMetamask=function hasMetamask(){var provider=web3.currentProvider;if(provider&&provider===window.ethereum&&provider.isMetaMask){console.log(\"MetaMask is installed!\");return true;}else{return false;}};/*\n  const handlerClik =  useCallback(async(e) => {\n    e.preventDefault();\n    if (hasMetamask()) {\n      console.log(\"OK METAMASK\");\n      console.log(web3.eth.accounts[0]);\n      const accounts = await web3.eth.getAccounts()\n      console.log(accounts[0])\n      web3.eth.personal\n        .sign(\n          web3.utils.utf8ToHex(\"Hello world\"),\n          \"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe\",\n          \"test password!\"\n        )\n        .then(console.log);\n    } else {\n      setFieldsModal({\n        success: \"false\",\n        danger: \"true\",\n        title: \"No Metamask Extension Founded\",\n        body: \"Please install Metamask extension\",\n        show: \"true\",\n        btnType: \"danger\",\n      });\n    }\n  }, []);\n  */var handlerClik=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var accounts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!hasMetamask()){_context.next=9;break;}_context.next=4;return web3.eth.getAccounts();case 4:accounts=_context.sent;console.log(accounts);// equivalente di web3.eth.personal.sign\n// web3.eth.personal.sign chiama questa fx\nwindow.ethereum.sendAsync({method:'personal_sign',params:[web3.utils.utf8ToHex('Hello world'),accounts[0]],from:accounts[0]},function(_err,_ref2){var result=_ref2.result;return _err?console.error(_err):console.log(result);});/*web3.eth.personal\n        .sign(\n          web3.utils.utf8ToHex(\"Hello world\"),\n          accounts[0]\n        )\n        .then(console.log);*/_context.next=10;break;case 9:setFieldsModal({success:\"false\",danger:\"true\",title:\"No Metamask Extension Founded\",body:\"Please install Metamask extension\",show:\"true\",btnType:\"danger\"});case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[hasMetamask,web3.eth,web3.utils]);console.log(\"A\",fieldsModal);return/*#__PURE__*/_jsxs(\"div\",{children:[fieldsModal!==undefined&&/*#__PURE__*/_jsx(Modal,{setFieldsModal:setFieldsModal,fieldsModal:fieldsModal}),/*#__PURE__*/_jsxs(Hero,{size:\"fullheight\",children:[/*#__PURE__*/_jsx(Hero.Header,{backgroundColor:\"primary\",children:/*#__PURE__*/_jsxs(Container,{my:5,display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",children:[/*#__PURE__*/_jsx(Image,{src:logo,size:128}),/*#__PURE__*/_jsx(Heading,{textColor:\"white\",children:\"Decentralized Login\"}),/*#__PURE__*/_jsx(Heading,{textColor:\"grey\",subtitle:true,size:3,children:\"Simple Login Demo with MetaMask\"})]})}),/*#__PURE__*/_jsx(Hero.Body,{children:/*#__PURE__*/_jsx(Container,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Content,{children:/*#__PURE__*/_jsx(Button,{size:\"medium\",loading:isLoading,rounded:\"true\",fullwidth:\"true\",color:\"warning\",onClick:handlerClik,children:\"Login with MetaMask\"})})})}),/*#__PURE__*/_jsx(Hero.Footer,{children:/*#__PURE__*/_jsx(Footer,{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Content,{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Decentralized Login Demo\"}),\" by\",\" \",/*#__PURE__*/_jsx(\"a\",{href:\"https://www.francescoprimerano.it\",rel:\"noreferrer\",target:\"_blank\",children:\"Francesco Primerano\"}),\". The source code is licensed under\",/*#__PURE__*/_jsxs(\"a\",{href:\"http://opensource.org/licenses/mit-license.php\",children:[\" \",\"MIT\"]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"The repository of this project is avaiable on\",\" \",/*#__PURE__*/_jsx(\"a\",{href:\"https://github.com/pf55351/dencentralizedLogin\",rel:\"noreferrer\",target:\"_blank\",children:\"github\"})]})]})})})})]})]});}export default App;","map":{"version":3,"sources":["/Users/francescoprimerano/Desktop/metamask-login/frontend/src/App.js"],"names":["useState","useCallback","Container","Heading","Content","Button","Image","Hero","Footer","Web3","Modal","App","isLoading","setIsLoading","ethAddress","setEthAddress","undefined","fieldsModal","setFieldsModal","web3","givenProvider","hasMetamask","provider","currentProvider","window","ethereum","isMetaMask","console","log","handlerClik","e","preventDefault","eth","getAccounts","accounts","sendAsync","method","params","utils","utf8ToHex","from","_err","result","error","success","danger","title","body","show","btnType","logo","textAlign"],"mappings":"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","sourcesContent":["import { useState, useCallback } from \"react\";\nimport \"bulma/css/bulma.min.css\";\nimport {\n  Container,\n  Heading,\n  Content,\n  Button,\n  Image,\n} from \"react-bulma-components\";\nimport Hero from \"react-bulma-components/esm/components/hero\";\nimport Footer from \"react-bulma-components/cjs/components/footer\";\nimport logo from \"./metamask.svg\";\nimport Web3 from \"web3\";\nimport Modal from \"./Modal\";\n\nfunction App() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [ethAddress, setEthAddress] = useState(\"\");\n  const [fieldsModal, setFieldsModal] = useState(undefined);\n\n  let web3 = new Web3(Web3.givenProvider);\n  const hasMetamask = () => {\n    const provider = web3.currentProvider;\n    if (provider && provider === window.ethereum && provider.isMetaMask) {\n      console.log(\"MetaMask is installed!\");\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  /*\n  const handlerClik =  useCallback(async(e) => {\n    e.preventDefault();\n    if (hasMetamask()) {\n      console.log(\"OK METAMASK\");\n      console.log(web3.eth.accounts[0]);\n      const accounts = await web3.eth.getAccounts()\n      console.log(accounts[0])\n      web3.eth.personal\n        .sign(\n          web3.utils.utf8ToHex(\"Hello world\"),\n          \"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe\",\n          \"test password!\"\n        )\n        .then(console.log);\n    } else {\n      setFieldsModal({\n        success: \"false\",\n        danger: \"true\",\n        title: \"No Metamask Extension Founded\",\n        body: \"Please install Metamask extension\",\n        show: \"true\",\n        btnType: \"danger\",\n      });\n    }\n  }, []);\n  */\n\n  const handlerClik = useCallback(async (e) => {\n    e.preventDefault();\n    if (hasMetamask()) {\n      const accounts = await web3.eth.getAccounts()\n      console.log(accounts);\n      // equivalente di web3.eth.personal.sign\n      // web3.eth.personal.sign chiama questa fx\n      window.ethereum.sendAsync(\n        {\n          method: 'personal_sign',\n          params: [web3.utils.utf8ToHex('Hello world'), accounts[0]],\n          from: accounts[0]\n        },\n        (_err, { result }) => (_err ? console.error(_err) : console.log(result))\n      )\n\n      /*web3.eth.personal\n        .sign(\n          web3.utils.utf8ToHex(\"Hello world\"),\n          accounts[0]\n        )\n        .then(console.log);*/\n    } else {\n      setFieldsModal({\n        success: \"false\",\n        danger: \"true\",\n        title: \"No Metamask Extension Founded\",\n        body: \"Please install Metamask extension\",\n        show: \"true\",\n        btnType: \"danger\",\n      });\n    }\n  }, [hasMetamask, web3.eth, web3.utils]);\n\n  console.log(\"A\", fieldsModal);\n\n  return (\n    <div>\n      {fieldsModal !== undefined && (\n        <Modal setFieldsModal={setFieldsModal} fieldsModal={fieldsModal} />\n      )}\n      <Hero size=\"fullheight\">\n        <Hero.Header backgroundColor=\"primary\">\n          <Container\n            my={5}\n            display=\"flex\"\n            flexDirection=\"column\"\n            alignItems=\"center\"\n            justifyContent=\"center\"\n          >\n            <Image src={logo} size={128} />\n            <Heading textColor={\"white\"}>Decentralized Login</Heading>\n            <Heading textColor=\"grey\" subtitle size={3}>\n              Simple Login Demo with MetaMask\n            </Heading>\n          </Container>\n        </Hero.Header>\n        <Hero.Body>\n          <Container display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\n            <Content>\n              <Button\n                size=\"medium\"\n                loading={isLoading}\n                rounded=\"true\"\n                fullwidth=\"true\"\n                color=\"warning\"\n                onClick={handlerClik}\n              >\n                Login with MetaMask\n              </Button>\n            </Content>\n          </Container>\n        </Hero.Body>\n        <Hero.Footer>\n          <Footer>\n            <Container>\n              <Content style={{ textAlign: \"center\" }}>\n                <p>\n                  <strong>Decentralized Login Demo</strong> by{\" \"}\n                  <a\n                    href=\"https://www.francescoprimerano.it\"\n                    rel=\"noreferrer\"\n                    target=\"_blank\"\n                  >\n                    Francesco Primerano\n                  </a>\n                  . The source code is licensed under\n                  <a href=\"http://opensource.org/licenses/mit-license.php\">\n                    {\" \"}\n                    MIT\n                  </a>\n                </p>\n                <p>\n                  The repository of this project is avaiable on{\" \"}\n                  <a\n                    href=\"https://github.com/pf55351/dencentralizedLogin\"\n                    rel=\"noreferrer\"\n                    target=\"_blank\"\n                  >\n                    github\n                  </a>\n                </p>\n              </Content>\n            </Container>\n          </Footer>\n        </Hero.Footer>\n      </Hero>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}